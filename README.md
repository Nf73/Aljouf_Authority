# مشروع التنبؤ بمدة معالجة بلاغات التشوه البصري – أمانة منطقة الجوف

## نظرة عامة
يهدف هذا المشروع إلى بناء نموذج تنبؤي يعتمد على الذكاء الاصطناعي لتقدير المدة المتوقعة (بالأيام) لمعالجة بلاغات التشوه البصري في أمانة منطقة الجوف. لزيادة الشفافية في العمل بين المواطن و الأمانة  

---

## الأهداف
- تقدير عدد الأيام لمعالجة البلاغ اعتمادًا على بيانات تاريخية.
- تمكين الأمانة من التخطيط التشغيلي وتوزيع الموارد بكفاءة.
- رفع مستوى الشفافية للمواطن عبر إظهار مدة متوقعة قبل تقديم البلاغ.

---

## البيانات
حقول البيانات الرئيسية المستخدمة:
- البلدية
- التصنيف الرئيسي
- التصنيف الفرعي
- التصنيف التخصصي
- تاريخ الإنشاء → تم اشتقاق: شهر_البلاغ، يوم_في_الأسبوع، ساعة_البلاغ
- عدد الأيام (المدة الفعلية لمعالجة البلاغ) ← الهدف (Target)

معالجات البيانات:
- تصفية البلاغات المغلقة فقط.
- حذف الأعمدة غير المؤثرة (مثل رقم البلاغ، ونوع التصنيف التخصصي عندما تكون قيمته ثابتة).
- معالجة القيم المفقودة.
- التعامل مع القيم المتطرفة باستخدام أسلوبي:
  - حذف جزئي لنصف أعلى القيم المتطرفة لتحسين الدقة مع الحفاظ على التوزيع.
- ترميز الفئات النصية باستخدام Label Encoding.

---

## النمذجة والنتائج
تمت تجربة عدة خوارزميات:
- Random Forest Regressor
- Gradient Boosting
- XGBoost Regressor

النموذج المعتمد: **Random Forest Regressor**  
النتائج على مجموعة الاختبار:
- **MAE** ≈ 1.15 يوم
- **R²** ≈ 0.53

أهم الميزات تأثيرًا وفقًا لتحليل Feature Importance:
- التصنيف الرئيسي
- البلدية
- السمات الزمنية (شهر البلاغ، ساعة البلاغ، يوم في الأسبوع)

> الدرجات قد تختلف باختلاف النسخة النهائية من البيانات وإعدادات المعالجة.

---

## هيكل المستودع

├─ Jouf.ipynb # تحليل استكشافي وتجهيز البيانات وبناء النموذج  
├─ Jouf_Api.py # واجهة برمجية Flask للتنبؤ  
├─ Jouf_Streamlit.py # واجهة Streamlit موجهة للمواطن  
├─ model.pkl # النموذج المدرّب  
├─ label_encoders.pkl # محولات الترميز LabelEncoders للأعمدة الفئوية  
├─ features.pkl # ترتيب/أسماء الميزات المستخدمة في التنبؤ  
└─ README.md  

---

## المتطلبات
- Python 3.9+
- حزم رئيسية:

![Pandas](https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white)
![NumPy](https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white)
![Streamlit](https://img.shields.io/badge/Streamlit-FF4B4B?style=for-the-badge&logo=Streamlit&logoColor=white)
![scikit-learn](https://img.shields.io/badge/scikit-learn-FF4B4B?style=for-the-badge&logo=scikit-learn&logoColor=white)
![joblib](https://img.shields.io/badge/joblib-FF4B4B?style=for-the-badge&logo=joblib&logoColor=white)
![flask](https://img.shields.io/badge/flask-FF4B4B?style=for-the-badge&logo=flask&logoColor=white)

  - xgboost (اختياري للتجارب)  
  - openpyxl (لقراءة Excel)  



## عرض واجهة التطبيق

<img width="100%" height="300" alt="واجهة التطبيق" src="https://github.com/user-attachments/assets/79336f70-b4de-4217-aef5-2c98f857a6c9" />


تثبيت الحزم:
```bash
pip install -r requirements.txt

python Jouf_Api.py
{
  "البلدية": "سكاكا",
  "التصنيف الرئيسى": "النظافة",
  "التصنيف الفرعي": "حاويات النفايات",
  "التصنيف التخصصي": "ازالة او نقل حاوية نفايات",
  "شهر_البلاغ": 1,
  "يوم_في_الأسبوع": 2,
  "ساعة_البلاغ": 14,
  "تصنيف_ثقيل": 0
}

streamlit run Jouf_Streamlit.py


تدريب وإعادة بناء النموذج
استخدم Jouf.ipynb لإعادة:

قراءة البيانات وتنظيفها.

تنفيذ EDA.

المعالجة المسبقة والترميز.

بناء النموذج وتقييمه.

احفظ المخرجات:

model.pkl

label_encoders.pkl

features.pkl

عند أي تغيير في البيانات أو ميزات الإدخال، يجب إعادة تدريب النموذج وإعادة حفظ الملفات الثلاثة، ثم إعادة تشغيل الـ API وواجهة Streamlit.

اعتبارات جودة البيانات
يجب أن تحتوي البيانات على بلاغات مغلقة فقط لوجود مدة معالجة فعلية.

القيم الزمنية تُستخرج من تاريخ الإنشاء.

التأكد من اتساق القيم النصية بين التدريب والإنتاج؛ أي قيمة غير معروفة للـ LabelEncoder ستسبب خطأ.



